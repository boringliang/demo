<!DOCTYPE html>
<html lang="en" dir="ltr" xmlns="http://www.w3.org/1999/html">

<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <title>Sleek - Admin Dashboard Template</title>

    <!-- GOOGLE FONTS -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,500|Poppins:400,500,600,700|Roboto:400,500"
          rel="stylesheet"/>
    <link href="https://cdn.materialdesignicons.com/3.0.39/css/materialdesignicons.min.css" rel="stylesheet"/>

    <!-- PLUGINS CSS STYLE -->
    <link href="../../static/assets/plugins/toaster/toastr.min.css" rel="stylesheet"/>
    <link href="../../static/assets/plugins/nprogress/nprogress.css" rel="stylesheet"/>
    <link href="../../static/assets/plugins/flag-icons/css/flag-icon.min.css" rel="stylesheet"/>
    <link href="../../static/assets/plugins/jvectormap/jquery-jvectormap-2.0.3.css" rel="stylesheet"/>
    <link href="../../static/assets/plugins/ladda/ladda.min.css" rel="stylesheet"/>
    <link href="../../static/assets/plugins/select2/css/select2.min.css" rel="stylesheet"/>
    <link href="../../static/assets/plugins/daterangepicker/daterangepicker.css" rel="stylesheet"/>

    <!-- SLEEK CSS -->
    <link id="sleek-css" rel="stylesheet" href="../../static/assets/css/sleek.css"/>


    <!-- FAVICON -->
    <link href="../../static/assets/img/favicon.png" rel="shortcut icon"/>

    <!--
      HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries
    -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script src="../../static/assets/plugins/nprogress/nprogress.js"></script>
    <!--    <script src="../../static/assets/d3.js" charset="utf-8"></script>-->
    <!--    <script src="../../static/assets/d3.min.js" charset="utf-8"></script>-->
    <script src="../../static/assets/js/echarts.min.js"></script>
    <!--    <script src="../../static/assets/js/echarts-gl.min.js"></script>-->


    <script src="../../static/assets/plugins/jquery/jquery.min.js"></script>
    <!--    <script src="../../static/assets/widgets/code/jquery.calendar.js"></script>-->
    <!--    <script src="../../static/assets/widgets/code/jquery.popup.js"></script>-->
    <!--    <script src="../../static/assets/LYWutils_traffic_jam.js"></script>-->
    <!--    <script charset="utf-8" src="https://map.qq.com/api/js?v=2.exp&key=PUBBZ-ED365-YF4IE-QAFHX-EE6M2-UVFFI"></script>-->
    <script src="../../static/assets/js/lyw/sidebar.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12"></script>
    <!-- 引入样式 -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <!-- 引入组件库 -->
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>

</head>


<body class="sidebar-fixed sidebar-dark header-light header-fixed" id="body">
<script>
    NProgress.configure({showSpinner: false});
    NProgress.start();
</script>

<div class="mobile-sticky-body-overlay"></div>

<div class="wrapper">

    <!--
====================================
——— LEFT SIDEBAR WITH FOOTER
=====================================
-->


    <div class="page-wrapper" style="overflow: auto; width: 1600px; height: 100%">
        <!-- Header -->
        <header class="main-header " id="header">
            <nav class="navbar navbar-static-top navbar-expand-lg">
                <!-- Sidebar toggle button -->
                <button id="sidebar-toggler" class="sidebar-toggle">
                    <span class="sr-only">Toggle navigation</span>
                </button>
                <!-- search form -->
                <div class="search-form d-none d-lg-inline-block">
                    <div class="input-group">
                        <button type="button" name="search" id="search-btn" class="btn btn-flat">
                            <i class="mdi mdi-magnify"></i>
                        </button>
                        <input type="text" name="query" id="search-input" class="form-control"
                               placeholder="'button', 'chart' etc." autofocus autocomplete="off"/>
                    </div>
                    <div id="search-results-container">
                        <ul id="search-results"></ul>
                    </div>
                </div>

                <div class="navbar-right ">
                    <ul class="nav navbar-nav">
                        <!-- Github Link Button -->
                        <li class="github-link mr-3">
                            <a class="btn btn-outline-secondary btn-sm"
                               href="https://github.com/tafcoder/sleek-dashboard"
                               target="_blank">
                                <span class="d-none d-md-inline-block mr-2">Source Code</span>
                                <i class="mdi mdi-github-circle"></i>
                            </a>

                        </li>
                        <li class="dropdown notifications-menu">
                            <button class="dropdown-toggle" data-toggle="dropdown">
                                <i class="mdi mdi-bell-outline"></i>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-right">
                                <li class="dropdown-header">You have 5 notifications</li>
                                <li>
                                    <a href="#">
                                        <i class="mdi mdi-account-plus"></i> New user registered
                                        <span class=" font-size-12 d-inline-block float-right"><i
                                                class="mdi mdi-clock-outline"></i> 10
                        AM</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        <i class="mdi mdi-account-remove"></i> User deleted
                                        <span class=" font-size-12 d-inline-block float-right"><i
                                                class="mdi mdi-clock-outline"></i> 07
                        AM</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        <i class="mdi mdi-chart-areaspline"></i> Sales report is ready
                                        <span class=" font-size-12 d-inline-block float-right"><i
                                                class="mdi mdi-clock-outline"></i> 12
                        PM</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        <i class="mdi mdi-account-supervisor"></i> New client
                                        <span class=" font-size-12 d-inline-block float-right"><i
                                                class="mdi mdi-clock-outline"></i> 10
                        AM</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        <i class="mdi mdi-server-network-off"></i> Server overloaded
                                        <span class=" font-size-12 d-inline-block float-right"><i
                                                class="mdi mdi-clock-outline"></i> 05
                        AM</span>
                                    </a>
                                </li>
                                <li class="dropdown-footer">
                                    <a class="text-center" href="#"> View All </a>
                                </li>
                            </ul>
                        </li>
                        <!-- User Account -->
                        <li class="dropdown user-menu">
                            <button href="#" class="dropdown-toggle nav-link" data-toggle="dropdown">
                                <img src="../../static/assets/img/user/user.png" class="user-image" alt="User Image"/>
                                <span class="d-none d-lg-inline-block">Abdus Salam</span>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-right">
                                <!-- User image -->
                                <li class="dropdown-header">
                                    <img src="../../static/assets/img/user/user.png" class="img-circle"
                                         alt="User Image"/>
                                    <div class="d-inline-block">
                                        Abdus Salam <small class="pt-1">abdus@gmail.com</small>
                                    </div>
                                </li>

                                <li>
                                    <a href="profile.html">
                                        <i class="mdi mdi-account"></i> My Profile
                                    </a>
                                </li>
                                <li>
                                    <a href="email-inbox.html">
                                        <i class="mdi mdi-email"></i> Message
                                    </a>
                                </li>
                                <li>
                                    <a href="#"> <i class="mdi mdi-diamond-stone"></i> Projects </a>
                                </li>
                                <li>
                                    <a href="#"> <i class="mdi mdi-settings"></i> Account Setting </a>
                                </li>

                                <li class="dropdown-footer">
                                    <a href="signin.html"> <i class="mdi mdi-logout"></i> Log Out </a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </nav>


        </header>


        <div class="content-wrapper">
            <div id="content">
                <template id="drawer">
                    <el-drawer
                            title="该点及其相似点的集合如下"
                            :visible.sync="table"
                            direction="rtl"
                            size="50%">
                        <el-table
                                :data="gridData"
                                height="500"
                                border
                                style="width: 100%">
                            <el-table-column type="expand">
                                <template slot-scope="props">
                                    <el-form label-position="left" inline class="demo-table-expand">
                                        <el-form-item label="行政区划">
                                            <span>{{ props.row.xzqh }}</span>
                                        </el-form-item>
                                        <el-form-item label="道路类型">
                                            <span>{{ props.row.dllx }}</span>
                                        </el-form-item>
                                        <el-form-item label="公路行政等级">
                                            <span>{{ props.row.glxzdj }}</span>
                                        </el-form-item>
                                        <el-form-item label="地点米数">
                                            <span>{{ props.row.ddms }}</span>
                                        </el-form-item>
                                        <el-form-item label="发现机关">
                                            <span>{{ props.row.fxjg }}</span>
                                        </el-form-item>
                                        <el-form-item label="发现机关名称">
                                            <span>{{ props.row.fxjgmc }}</span>
                                        </el-form-item>
                                        <el-form-item label="准驾车型">
                                            <span>{{ props.row.zjcx }}</span>
                                        </el-form-item>
                                        <el-form-item label="住所行政区划">
                                            <span>{{ props.row.zsxzqh }}</span>
                                        </el-form-item>
                                        <el-form-item label="住所详细地址">
                                            <span>{{ props.row.zsxzdz }}</span>
                                        </el-form-item>
                                        <el-form-item label="电话">
                                            <span>{{ props.row.dh }}</span>
                                        </el-form-item>
                                        <el-form-item label="联系方式">
                                            <span>{{ props.row.lxfs }}</span>
                                        </el-form-item>
                                        <el-form-item label="车辆分类">
                                            <span>{{ props.row.clfl }}</span>
                                        </el-form-item>
                                        <el-form-item label="号牌种类">
                                            <span>{{ props.row.hpzl }}</span>
                                        </el-form-item>
                                        <el-form-item label="机动车所有人">
                                            <span>{{ props.row.jdcsyr }}</span>
                                        </el-form-item>
                                        <el-form-item label="机动车使用性质">
                                            <span>{{ props.row.syxz }}</span>
                                        </el-form-item>
                                        <el-form-item label="交通方式">
                                            <span>{{ props.row.jtfs }}</span>
                                        </el-form-item>
                                    </el-form>
                                </template>
                            </el-table-column>
                            <el-table-column
                                    prop="wfbh"
                                    label="违法编号"
                                    sortable
                                    fixed
                                    width="100">
                            </el-table-column>
                            <el-table-column
                                    prop="wfsj"
                                    label="违法时间"
                                    sortable
                                    width="100">
                            </el-table-column>
                            <el-table-column
                                    prop="wfdd"
                                    label="道路代码"
                                    sortable
                                    width="100">
                            </el-table-column>
                            <el-table-column
                                    prop="lddm"
                                    label="路口代码或距离"
                                    sortable
                                    width="100">
                            </el-table-column>
                            <el-table-column
                                    prop="dsr"
                                    label="当事人"
                                    sortable
                                    width="100">
                            </el-table-column>
                            <el-table-column
                                    prop="hphm"
                                    label="号牌号码"
                                    sortable
                                    width="100">
                            </el-table-column>
                            <el-table-column
                                    prop="jszh"
                                    label="驾驶证号"
                                    sortable
                                    width="100">
                            </el-table-column>
                            <el-table-column
                                    prop="cljg"
                                    label="处理机关名称"
                                    sortable
                                    width="100">
                            </el-table-column>
                            <el-table-column
                                    prop="fkje"
                                    label="罚款金额"
                                    sortable
                                    width="100">
                            </el-table-column>
                            <el-table-column
                                    prop="wfjfs"
                                    label="违法记分数"
                                    sortable
                                    width="100">
                            </el-table-column>
                            <el-table-column
                                    prop="wfxw"
                                    label="违法行为"
                                    sortable
                                    width="100">
                            </el-table-column>
                            <el-table-column
                                    prop="jkbj"
                                    label="交款标记"
                                    sortable
                                    width="100">
                            </el-table-column>
                            <el-table-column
                                    prop="sgdj"
                                    label="事故等级"
                                    sortable
                                    width="100">
                            </el-table-column>
                        </el-table>
                    </el-drawer>
                </template>
                <template id="slide">
                    <div class="block">
                        <span class="demonstration">相似性度量(相异度选择一般小于0.5,相似度选择一般大于0.5)</span>
                        <span class="demonstration">当选择相异度时，相异度在圆点以左范围的事件被连线;选择相似度时，相似度在圆点以右范围的事件被连线</span>
                        <!--                        </span><button @click="graph">生成图</button>-->
                        <el-slider v-model="value" :format-tooltip="formatTooltip"></el-slider>
                    </div>
                </template>
                <template id="calendar">
                    <div class="block">
                        <span class="demonstration">日期选择</span>
                        <el-date-picker
                                v-model="value"
                                type="datetimerange"
                                range-separator="至"
                                start-placeholder="开始日期"
                                end-placeholder="结束日期">
                        </el-date-picker>
                    </div>
                </template>
                <template id="time_slide">
                    <div class="block">
                        <span class="demonstration">每日时段选择</span>
                        <el-slider v-model="value" range :max="86400" :format-tooltip="formatTooltip"></el-slider>
                    </div>
                </template>

                <template id="selections">
                    <el-select
                            v-model="value"
                            clearable
                            multiple
                            collapse-tags
                            style="margin-left: 20px;"
                            placeholder="请选择违法地点">
                        <el-option
                                v-for="item in options"
                                :key="item.value"
                                :label="item.label"
                                :value="item.value">
                        </el-option>
                    </el-select>
                </template>
                <template id="similarity_selections">
                    <el-select
                            v-model="value"
                            style="margin-left: 20px;"
                            placeholder="请选择相似度量方法">
                        <el-option
                                v-for="item in options"
                                :key="item.value"
                                :label="item.label"
                                :value="item.value">
                        </el-option>
                    </el-select>
                </template>
                <div id="graph" style="height: 800px; width: 100%"></div>
                <template id="table" v-if=false>
                    <el-table
                            :data="tableData"
                            height="500"
                            border
                            style="width: 100%">
                        <el-table-column type="expand">
                            <template slot-scope="props">
                                <el-form label-position="left" inline class="demo-table-expand">
                                    <el-form-item label="行政区划">
                                        <span>{{ props.row.XZQH }}</span>
                                    </el-form-item>
                                    <el-form-item label="道路类型">
                                        <span>{{ props.row.DLLX }}</span>
                                    </el-form-item>
                                    <el-form-item label="公路行政等级">
                                        <span>{{ props.row.GLXZDJ }}</span>
                                    </el-form-item>
                                    <el-form-item label="地点米数">
                                        <span>{{ props.row.DDMS }}</span>
                                    </el-form-item>
                                    <el-form-item label="发现机关">
                                        <span>{{ props.row.FXJG }}</span>
                                    </el-form-item>
                                    <el-form-item label="发现机关名称">
                                        <span>{{ props.row.FXJGMC }}</span>
                                    </el-form-item>
                                    <el-form-item label="准驾车型">
                                        <span>{{ props.row.ZJCX }}</span>
                                    </el-form-item>
                                    <el-form-item label="住所行政区划">
                                        <span>{{ props.row.ZSXZQH }}</span>
                                    </el-form-item>
                                    <el-form-item label="住所详细地址">
                                        <span>{{ props.row.ZSXZDZ }}</span>
                                    </el-form-item>
                                    <el-form-item label="电话">
                                        <span>{{ props.row.DH }}</span>
                                    </el-form-item>
                                    <el-form-item label="联系方式">
                                        <span>{{ props.row.LXFS }}</span>
                                    </el-form-item>
                                    <el-form-item label="车辆分类">
                                        <span>{{ props.row.CLFL }}</span>
                                    </el-form-item>
                                    <el-form-item label="号牌种类">
                                        <span>{{ props.row.HPZL }}</span>
                                    </el-form-item>
                                    <el-form-item label="机动车所有人">
                                        <span>{{ props.row.JDCSYR }}</span>
                                    </el-form-item>
                                    <el-form-item label="机动车使用性质">
                                        <span>{{ props.row.SYXZ }}</span>
                                    </el-form-item>
                                    <el-form-item label="交通方式">
                                        <span>{{ props.row.JTFS }}</span>
                                    </el-form-item>
                                </el-form>
                            </template>
                        </el-table-column>
                        <el-table-column
                                prop="WFBH"
                                label="违法编号"
                                sortable
                                fixed
                                width="100">
                        </el-table-column>
                        <el-table-column
                                prop="WFSJ"
                                label="违法时间"
                                sortable
                                width="100">
                        </el-table-column>
                        <el-table-column
                                prop="WFDD"
                                label="道路代码"
                                sortable
                                width="100">
                        </el-table-column>
                        <el-table-column
                                prop="LDDM"
                                label="路口代码或距离"
                                sortable
                                width="100">
                        </el-table-column>
                        <el-table-column
                                prop="CLJG"
                                label="处理机关名称"
                                sortable
                                width="100">
                        </el-table-column>
                        <el-table-column
                                prop="DSR"
                                label="当事人"
                                sortable
                                width="100">
                        </el-table-column>
                        <el-table-column
                                prop="JSZH"
                                label="驾驶证号"
                                sortable
                                width="100">
                        </el-table-column>
                        <el-table-column
                                prop="HPHM"
                                label="号牌号码"
                                sortable
                                width="100">
                        </el-table-column>
                        <el-table-column
                                prop="FKJE"
                                label="罚款金额"
                                sortable
                                width="100">
                        </el-table-column>
                        <el-table-column
                                prop="WFJFS"
                                label="违法记分数"
                                sortable
                                width="100">
                        </el-table-column>
                        <el-table-column
                                prop="WFXW"
                                label="违法行为"
                                sortable
                                width="100">
                        </el-table-column>
                        <el-table-column
                                prop="JKBJ"
                                label="交款标记"
                                sortable
                                width="100">
                        </el-table-column>
                        <el-table-column
                                prop="SGDJ"
                                label="事故等级"
                                sortable
                                width="100">
                        </el-table-column>
                    </el-table>
                </template>
            </div>
            <script> //下面是所有的函数和表
            CATAGORY_SIMILARITY_LIST = new Array("xzqh","dllx","glxzdj","wfdd","lddm","cljg","fxjg","jszh","dsr","clfl","hpzl","hphm","syxz","wfxw","jkbj","sgdj");
            NUMERICAL_SIMILARITY_LIST = new Array("wfsj","fkje","wfjfs");
            MAX_DATE = new Date('2020-06-09 17:10:00');
            MIN_DATE = new Date('2020-04-10 17:15:51');
            MIN_FKJE = 0;
            MAX_FKJE = 50000;
            MIN_WFJFS = 0;
            MAX_WFJFS = 12;

            function dissimilarity(violation1, violation2, method) {
                //param: 事件的Object
                //return: 两个事件的相异度，取值从0到1
                //method: 计算的方法，可选'dis','sim','cos'
                if (method === 'dis') {
                    var denominator = 0;
                    var numerator = 0;
                    for (var i = 0; i < CATAGORY_SIMILARITY_LIST.length; i++) {
                        denominator++;
                        violation1[CATAGORY_SIMILARITY_LIST[i]] === violation2[CATAGORY_SIMILARITY_LIST[i]] ? numerator += 0 : numerator += 1;
                    }
                    denominator += NUMERICAL_SIMILARITY_LIST.length;
                    var d1 = new Date(violation1.wfsj);
                    var d2 = new Date(violation2.wfsj);
                    numerator += Math.abs(d1 - d2) / Math.abs(MIN_DATE - MAX_DATE);
                    numerator += Math.abs(parseInt(violation1.fkje) - parseInt(violation2.fkje)) / Math.abs(MIN_FKJE - MAX_FKJE);
                    numerator += Math.abs(parseInt(violation1.wfjfs) - parseInt(violation2.wfjfs)) / Math.abs(MIN_WFJFS - MAX_WFJFS);
                    return numerator / denominator;
                }
                if (method === 'cos') {
                    var up = 0;
                    for (var i = 0; i < violation1.onehot.length; i++) {
                        up += violation1.onehot[i] * violation2.onehot[i];
                    }
                    var downleft = 0;
                    var downright = 0;
                    for (var i = 0; i < violation1.onehot.length; i++) {
                        downleft += Math.pow(violation1.onehot[i], 2);
                    }
                    for (var i = 0; i < violation2.onehot.length; i++) {
                        downright += Math.pow(violation2.onehot[i], 2);
                    }
                    var down = Math.sqrt(downleft) + Math.sqrt(downright);
                    return up / down;
                }
                if (method === 'sim') {
                    var denominator = 0;
                    var numerator = 0;
                    for (var i = 0; i < CATAGORY_SIMILARITY_LIST.length; i++) {
                        denominator++;
                        violation1[CATAGORY_SIMILARITY_LIST[i]] === violation2[CATAGORY_SIMILARITY_LIST[i]] ? numerator += 1 : numerator += 0;
                    }
                    denominator += NUMERICAL_SIMILARITY_LIST.length;
                    var d1 = new Date(violation1.wfsj);
                    var d2 = new Date(violation2.wfsj);
                    numerator += 1 - Math.abs(d1 - d2) / Math.abs(MIN_DATE - MAX_DATE);
                    numerator += 1 - Math.abs(parseInt(violation1.fkje) - parseInt(violation2.fkje)) / Math.abs(MIN_FKJE - MAX_FKJE);
                    numerator += 1 - Math.abs(parseInt(violation1.wfjfs) - parseInt(violation2.wfjfs)) / Math.abs(MIN_WFJFS - MAX_WFJFS);
                    return numerator / denominator;
                }
            }
            links = new Array();
            datas = new Array(); //在日历变化以后把传过来的数据存储在datas里面，然后加了个name和value，为了算余弦相似，还得加一个字段来表示onehot
            datass = new Array(); //是用datas来初始化的
            //calendar的value是js的Date；slide的value是1到100的整数

            //下面是所有的Vue对象
            var drawer;
            if (undefined != drawer) {
                drawer.$destroy();
            }
            var MainDrawer = {
                data() {
                    return {
                        table: false,
                        dialog: false,
                        loading: false,
                        gridData: [],
                        form: {
                            name: '',
                            region: '',
                            date1: '',
                            date2: '',
                            delivery: false,
                            type: [],
                            resource: '',
                            desc: ''
                        },
                        formLabelWidth: '80px',
                        timer: null,
                    };
                },
                methods: {
                }
            };
            var CtorDrawer = Vue.extend(MainDrawer);
            var drawer = new CtorDrawer().$mount('#drawer');

            var calendar;
            if (undefined != calendar) {
                calendar.$destroy();
            }
            var MainCalendar = {
                data() {
                    return {
                        value: [new Date(2020, 3, 10, 10, 10), new Date(2020, 5, 9, 10, 10)],
                    };
                },
                watch: {
                    value: function() {
                        $.ajax({
                            url: "VIOLATION_eventgraph_ajax",
                            type: "POST",
                            data: {
                                // "times": calendar.value,
                                // "dissimilarity": slide.value
                                "time1": calendar.value[0],
                                "time2": calendar.value[1],
                                "time_range1": timeSlide.formatTooltip(timeSlide.value[0]),
                                "time_range2": timeSlide.formatTooltip(timeSlide.value[1]),
                            },
                            success: function(data) {
                                // var WFDDs = data["WFDDs"];
                                // var wfdds = new Array();
                                // for (var i = 0; i < WFDDs.length; i++) {
                                //     var o = new Object();
                                //     o.value = WFDDs[i];
                                //     o.label = o.value;
                                //     wfdds.push(o);
                                // }
                                selections.options = [];
                                // selections.options = wfdds;
                                var temp = new Array();
                                for (var i = 0; i < data.length; i++) {
                                    if (temp.indexOf(data[i].wfdd) === -1) {
                                        temp.push(data[i].wfdd);
                                    }
                                }
                                var tempt = new Array();
                                for (var i = 0; i < temp.length; i++) {
                                    var a = new Object();
                                    a.value = temp[i];
                                    a.label = temp[i];
                                    tempt.push(a);
                                }
                                tempt.unshift({value: 'all', label: '全选'});
                                selections.options = tempt;
                                // datas = getObject(data);
                                datas = data;

                                //下面是给datas加上onehot字段
                                //做所有字段的索引表
                                // var index_table = new Array();
                                // for (var i = 0; i < CATAGORY_SIMILARITY_LIST.length; i++) {
                                //     var field = datas.map(o => o[CATAGORY_SIMILARITY_LIST[i]]);
                                //     var field_set = new Set(field);
                                //     var field_filtered = Array.from(field_set);
                                //     field_filtered.sort();
                                //     var temp = new Object();
                                //     for (var j = 0; j < field_filtered.length; j++) {
                                //         temp[field_filtered[i]] = j;
                                //     }
                                //     index_table.push(temp);
                                // }
                                // for (var i = 0; i < datas.length; i++) {
                                //     var onehot = new Array();
                                //     for (var j = 0; j < CATAGORY_SIMILARITY_LIST.length; j++) {
                                //         var table = index_table[j];
                                //         var field_onehot = new Array();
                                //         for (var k = 0; k < Object.keys(table); k++) {
                                //             field_onehot.push(0);
                                //         }
                                //         field_onehot[table[datas[i][CATAGORY_SIMILARITY_LIST[j]]]] = 1;
                                //         onehot.concat(field_onehot);
                                //     }
                                //     datas[i].onehot = onehot;
                                // }
                                //加onehot结束


                                links = new Array();
                                for (var i = 0; i < datas.length; i++) {
                                    datas[i].value = 20;
                                    datas[i].name = datas[i].wfbh;
                                }
                                var matrix = new Array(datas.length);
                                for (var i = 0; i < matrix.length; i++) {
                                    matrix[i] = new Array(datas.length);
                                }
                                for (var i = 0; i < datas.length; i++) {
                                    for (var j = 0; j < datas.length; j++) {
                                        if (i === j) {matrix[i][j] = 0;}
                                        else {
                                            var dis = dissimilarity(datas[i],datas[j], similaritySelections.value);
                                            matrix[i][j] = dis;
                                            // datas[i].value += 3;
                                            // datas[j].value += 3;
                                            if (similaritySelections.value === 'dis') {
                                                if (dis < slide.value / 100) {
                                                    links.push({
                                                        source: datas[i].name,
                                                        target: datas[j].name,
                                                    });
                                                }
                                            }
                                            if (similaritySelections.value === 'sim') {
                                                if (dis > slide.value / 100) {
                                                    links.push({
                                                        source: datas[i].name,
                                                        target: datas[j].name,
                                                    });
                                                }
                                            }

                                        }
                                    }
                                }
                                // table_data = [];
                                // for (var i = 0; i < datas.length; i++) {
                                //     var similar_links = links.filter(
                                //         (o) => {
                                //             if ((o.target === datas[i].name) || (o.source === datas[i].name)) {
                                //                 return o;
                                //             }
                                //         }
                                //     )
                                //     var similar_datas_name = new Set();
                                //     for (var i = 0; i < similar_links.length; i++) {
                                //         similar_datas_name.add(similar_links[i].source);
                                //         similar_datas_name.add(similar_links[i].target);
                                //     }
                                //     var similar_datas_name = Array.from(similar_datas_name);
                                //     var similar_datas = datas.filter(
                                //         (o) => {
                                //             if (similar_datas_name.indexOf(o.name) >= 0) {
                                //                 return o;
                                //             }
                                //         }
                                //     )
                                //     for (var i = 0; i < similar_datas.length; i++) {
                                //         table_data.push(similar_datas[i]);
                                //     }
                                // }
                                // table.tableData = table_data;

                                // 初始化，如果你的容器id为main的<div></div>
                                var myChart;
                                if (undefined != myChart) {
                                    myChart.remove();
                                }
                                var myChart = echarts.init(
                                    document.getElementById('graph')
                                )
                                myChart.clear();
                                // 分类集合
                                // var categories = [
                                //     {name: '学校'},
                                //     {name: '属性'},
                                //     {name: '其他'}
                                // ]
                                // 配置项
                                var option = {
                                    // 提示框设置
                                    tooltip: {
                                        // 关闭提示框
                                        show: true,
                                        trigger: 'item',
                                        formatter(params) {
                                            var out = '';
                                            // for (p in params) {
                                            out += '<p>' + '违法编号:' + params.data.wfbh + '</p>';
                                            out += '<p>' + '违法时间:' + params.data.wfsj + '</p>';
                                            out += '<p>' + '违法地址:' + params.data.wfdz + '</p>';
                                            out += '<p>' + '当事人:' + params.data.dsr + '</p>';
                                            out += '<p>' + '违法行为:' + params.data.wfxw + '</p>';
                                            out += '<p>' + '处理机关名称:' + params.data.cljgmc + '</p>';
                                            out += '<p>' + '罚款金额:' + params.data.fkje + '</p>';
                                            out += '<p>' + '违法记分数:' + params.data.wfjfs + '</p>';
                                            out += '<p>' + '事故等级:' + params.data.sgdj + '</p>';
                                            out += '<p>' + '行政区划:' + params.data.xzqh + '</p>';
                                            out += '<p>' + '公路行政等级:' + params.data.glxzdj + '</p>';
                                            out += '<p>' + '违法地点:' + params.data.wfdd + '</p>';
                                            out += '<p>' + '路口路段代码:' + params.data.lddm + '</p>';
                                            out += '<p>' + '驾驶证号:' + params.data.jszh + '</p>';
                                            out += '<p>' + '车辆分类:' + params.data.clfl + '</p>';
                                            out += '<p>' + '号牌种类:' + params.data.hpzl + '</p>';
                                            out += '<p>' + '号牌号码:' + params.data.hphm + '</p>';
                                            out += '<p>' + '机动车使用性质:' + params.data.syxz + '</p>';
                                            // }
                                            return out;
                                        }
                                    },
                                    // 图例设置
                                    // legend: [{
                                    // 纵向
                                    // orient: 'vertical',
                                    // 位置
                                    // left: 'right',
                                    // 图例内容，由上面的分类集合决定
                                    // data: categories.map(function (a) {
                                    //     return a.name;
                                    // })
                                    // }],
                                    // 数据设置
                                    series: [{
                                        // 类型
                                        type: 'graph',
                                        // 力导图布局
                                        layout: 'force',
                                        // 开启平移与缩放
                                        roam: true,
                                        // 标签设置
                                        // label: {
                                        //     normal: {
                                        // 是否展示
                                        // show: true,
                                        // 展示位置
                                        // position: 'top',
                                        // 展示内容
                                        // formatter: '{b}',
                                        // 文本设置
                                        // textStyle: {
                                        // 文本大小
                                        // fontSize: '12rem'
                                        // },
                                        // }
                                        // },
                                        // 根据value放缩节点
                                        symbolSize: (value, params) => {
                                            return value;
                                        },
                                        // 是否可拖拽
                                        draggable: true,
                                        // 节点数据
                                        data: datas,
                                        // data:[
                                        //     {
                                        // 分类
                                        // category: '学校',
                                        // 名称
                                        // name: "西安电子科技大学",
                                        // 值，越大则节点越大
                                        // value:50
                                        // },
                                        // {
                                        // category: '属性',
                                        // name: "《与共和国同行》",
                                        // value:30
                                        // },
                                        // {
                                        // category: '属性',
                                        // name: "杨宗凯",
                                        // value:30
                                        // },
                                        // {
                                        // category: 0,
                                        // name: "西北工业大学",
                                        // value:50
                                        // },
                                        // ],
                                        // 分类
                                        // categories: categories,
                                        force: {
                                            edgeLength: 200,
                                            repulsion: 300,
                                            // gravity: 0.1
                                        },
                                        // 关系
                                        links: links,
                                        // links:[
                                        //     {
                                        // 源节点
                                        // source: "西安电子科技大学",
                                        // 目标节点
                                        // target: "《与共和国同行》",
                                        // 标签设置
                                        // label: {
                                        //     normal: {
                                        // 是否展示
                                        // show: true,
                                        // 展示内容
                                        // formatter: '校歌'
                                        // }
                                        // }
                                        // },
                                        // {
                                        //     source: "西安电子科技大学",
                                        //     target: "杨宗凯",
                                        // label: {
                                        //     normal: {
                                        //         show: true,
                                        //         formatter: '校长'
                                        //     }
                                        // }
                                        // },
                                        // {
                                        //     source: "西安电子科技大学",
                                        //     target: "西北工业大学",
                                        // label: {
                                        //     normal: {
                                        //         show: true,
                                        //         formatter: '兄弟院校'
                                        //     }
                                        // }
                                        // }
                                        // ],
                                    }]
                                };
                                myChart.setOption(option);
                                myChart.on('click', function(params) {
                                    return false;
                                });
                                myChart.on('click', function (params) {
                                    var similar_links = links.filter(
                                        (o) => {
                                            if ((o.target === params.name) || (o.source === params.name)) {
                                                return o;
                                            }
                                        }
                                    )
                                    var similar_datas_name = new Set();
                                    for (var i = 0; i < similar_links.length; i++) {
                                        similar_datas_name.add(similar_links[i].source);
                                        similar_datas_name.add(similar_links[i].target);
                                    }
                                    var similar_datas_name = Array.from(similar_datas_name);
                                    var similar_datas = datas.filter(
                                        (o) => {
                                            if (similar_datas_name.indexOf(o.name) >= 0) {
                                                return o;
                                            }
                                        }
                                    )
                                    drawer.gridData = similar_datas;
                                    drawer.table = true;
                                });
                            }
                        })

                    }
                }
            };
            var CtorCalendar = Vue.extend(MainCalendar);
            var calendar = new CtorCalendar().$mount('#calendar');

            var slide;
            if (undefined != slide) {
                slide.$destroy();
            }
            var MainSlide = {
                //相异度
                data() {
                    return {
                        value: 42
                    }
                },
                methods: {
                    formatTooltip(val) {
                        return val / 100;
                    },
                    graph:function() {
                        links = [];
                        var matrix = new Array(datas.length);
                        for (var i = 0; i < matrix.length; i++) {
                            matrix[i] = new Array(datas.length);
                        }
                        for (var i = 0; i < datas.length; i++) {
                            for (var j = 0; j < datas.length; j++) {
                                if (i === j) {matrix[i][j] = 0;}
                                else {
                                    var dis = dissimilarity(datas[i],datas[j], similaritySelections.value);
                                    matrix[i][j] = dis;
                                    // datas[i].value += 3;
                                    // datas[j].value += 3;
                                    if (similaritySelections.value === 'dis') {
                                        if (dis < slide.value / 100) {
                                            links.push({
                                                source: datas[i].name,
                                                target: datas[j].name,
                                            });
                                        }
                                    }
                                    if (similaritySelections.value === 'sim') {
                                        if (dis > slide.value / 100) {
                                            links.push({
                                                source: datas[i].name,
                                                target: datas[j].name,
                                            });
                                        }
                                    }

                                }
                            }
                        }
                        var myChart;
                        if (undefined != myChart) {
                            myChart.remove();
                        }

                        var myChart = echarts.init(
                            document.getElementById('graph')
                        )
                        myChart.clear();
                        var option = {
                            tooltip: {
                                show: true,
                                trigger: 'item',
                                formatter(params) {
                                    var out = '';
                                    // for (p in params) {
                                    out += '<p>' + '违法编号:' + params.data.wfbh + '</p>';
                                    out += '<p>' + '违法时间:' + params.data.wfsj + '</p>';
                                    out += '<p>' + '违法地址:' + params.data.wfdz + '</p>';
                                    out += '<p>' + '当事人:' + params.data.dsr + '</p>';
                                    out += '<p>' + '违法行为:' + params.data.wfxw + '</p>';
                                    out += '<p>' + '处理机关名称:' + params.data.cljgmc + '</p>';
                                    out += '<p>' + '罚款金额:' + params.data.fkje + '</p>';
                                    out += '<p>' + '违法记分数:' + params.data.wfjfs + '</p>';
                                    out += '<p>' + '事故等级:' + params.data.sgdj + '</p>';
                                    out += '<p>' + '行政区划:' + params.data.xzqh + '</p>';
                                    out += '<p>' + '公路行政等级:' + params.data.glxzdj + '</p>';
                                    out += '<p>' + '违法地点:' + params.data.wfdd + '</p>';
                                    out += '<p>' + '路口路段代码:' + params.data.lddm + '</p>';
                                    out += '<p>' + '驾驶证号:' + params.data.jszh + '</p>';
                                    out += '<p>' + '车辆分类:' + params.data.clfl + '</p>';
                                    out += '<p>' + '号牌种类:' + params.data.hpzl + '</p>';
                                    out += '<p>' + '号牌号码:' + params.data.hphm + '</p>';
                                    out += '<p>' + '机动车使用性质:' + params.data.syxz + '</p>';
                                    // }
                                    return out;
                                }
                            },
                            series: [{
                                type: 'graph',
                                layout: 'force',
                                roam: true,
                                symbolSize: (value, params) => {
                                    return value;
                                },
                                draggable: true,
                                data: datas,
                                force: {
                                    edgeLength: 200,
                                    repulsion: 300,
                                },
                                links: links,
                            }]
                        };
                        myChart.setOption(option);
                    }
                },
                watch: {
                    value: function() {
                        links = [];
                        if (datass.length === 0) {
                            for (var i = 0; i < datas.length; i++) {
                                datass.push(datas[i]);
                            }
                        }
                        var matrix = new Array(datass.length);
                        for (var i = 0; i < matrix.length; i++) {
                            matrix[i] = new Array(datass.length);
                        }
                        for (var i = 0; i < datass.length; i++) {
                            for (var j = 0; j < datass.length; j++) {
                                if (i === j) {matrix[i][j] = 0;}
                                else {
                                    var dis = dissimilarity(datass[i],datass[j], similaritySelections.value);
                                    matrix[i][j] = dis;
                                    // datass[i].value += 3;
                                    // datass[j].value += 3;
                                    if (similaritySelections.value === 'dis') {
                                        if (dis < slide.value / 100) {
                                            links.push({
                                                source: datas[i].name,
                                                target: datas[j].name,
                                            });
                                        }
                                    }
                                    if (similaritySelections.value === 'sim') {
                                        if (dis > slide.value / 100) {
                                            links.push({
                                                source: datas[i].name,
                                                target: datas[j].name,
                                            });
                                        }
                                    }

                                }
                            }
                        }
                        var myChart;
                        if (undefined != myChart) {
                            myChart.remove();
                        }

                        var myChart = echarts.init(
                            document.getElementById('graph')
                        )
                        myChart.clear();
                        var option = {
                            tooltip: {
                                show: true,
                                trigger: 'item',
                                formatter(params) {
                                    var out = '';
                                    // for (p in params) {
                                    out += '<p>' + '违法编号:' + params.data.wfbh + '</p>';
                                    out += '<p>' + '违法时间:' + params.data.wfsj + '</p>';
                                    out += '<p>' + '违法地址:' + params.data.wfdz + '</p>';
                                    out += '<p>' + '当事人:' + params.data.dsr + '</p>';
                                    out += '<p>' + '违法行为:' + params.data.wfxw + '</p>';
                                    out += '<p>' + '处理机关名称:' + params.data.cljgmc + '</p>';
                                    out += '<p>' + '罚款金额:' + params.data.fkje + '</p>';
                                    out += '<p>' + '违法记分数:' + params.data.wfjfs + '</p>';
                                    out += '<p>' + '事故等级:' + params.data.sgdj + '</p>';
                                    out += '<p>' + '行政区划:' + params.data.xzqh + '</p>';
                                    out += '<p>' + '公路行政等级:' + params.data.glxzdj + '</p>';
                                    out += '<p>' + '违法地点:' + params.data.wfdd + '</p>';
                                    out += '<p>' + '路口路段代码:' + params.data.lddm + '</p>';
                                    out += '<p>' + '驾驶证号:' + params.data.jszh + '</p>';
                                    out += '<p>' + '车辆分类:' + params.data.clfl + '</p>';
                                    out += '<p>' + '号牌种类:' + params.data.hpzl + '</p>';
                                    out += '<p>' + '号牌号码:' + params.data.hphm + '</p>';
                                    out += '<p>' + '机动车使用性质:' + params.data.syxz + '</p>';
                                    // }
                                    return out;
                                }
                            },
                            series: [{
                                type: 'graph',
                                layout: 'force',
                                roam: true,
                                symbolSize: (value, params) => {
                                    return value;
                                },
                                draggable: true,
                                data: datass,
                                force: {
                                    edgeLength: 200,
                                    repulsion: 300,
                                },
                                links: links,
                            }]
                        };
                        myChart.setOption(option);
                        // myChart.on('click', function(params) {
                        //     return false;
                        // });
                        //
                        // myChart.on('click', function (params) {
                        //     var similar_links = links.filter(
                        //         (o) => {
                        //             if ((o.target === params.name) || (o.source === params.name)) {
                        //                 return o;
                        //             }
                        //         }
                        //     )
                        //     var similar_datas_name = new Set();
                        //     for (var i = 0; i < similar_links.length; i++) {
                        //         similar_datas_name.add(similar_links[i].source);
                        //         similar_datas_name.add(similar_links[i].target);
                        //     }
                        //     var similar_datas_name = Array.from(similar_datas_name);
                        //     var similar_datas = datas.filter(
                        //         (o) => {
                        //             if (similar_datas_name.indexOf(o.name) >= 0) {
                        //                 return o;
                        //             }
                        //         }
                        //     )
                        //     console.log(similar_datas);
                        // });
                    }
                }
            }
            var CtorSlide = Vue.extend(MainSlide)
            var slide = new CtorSlide().$mount('#slide')

            var selections;
            if (undefined != selections) {
                selections.$destroy();
            }
            var MainSelections = {
                data() {
                    return {
                        options: [],
                        value: [],
                    }
                },
                watch: {
                    value: function() {
                        links = [];
                        datass = [];
                        if (selections.value.indexOf('all') >= 0) {
                            for (var i = 0; i < datas.length; i++) {
                                datass.push(datas[i]);
                            }
                        }
                        else {
                            for (var i = 0; i < datas.length; i++) {
                                if (selections.value.indexOf(datas[i].wfdd) >= 0) {
                                    datass.push(datas[i]);
                                }
                            }
                        }
                        var matrix = new Array(datass.length);
                        for (var i = 0; i < matrix.length; i++) {
                            matrix[i] = new Array(datass.length);
                        }
                        for (var i = 0; i < datass.length; i++) {
                            for (var j = 0; j < datass.length; j++) {
                                if (i === j) {matrix[i][j] = 0;}
                                else {
                                    var dis = dissimilarity(datass[i],datass[j], similaritySelections.value);
                                    matrix[i][j] = dis;
                                    // datass[i].value += 3;
                                    // datass[j].value += 3;
                                    if (similaritySelections.value === 'dis') {
                                        if (dis < slide.value / 100) {
                                            links.push({
                                                source: datas[i].name,
                                                target: datas[j].name,
                                            });
                                        }
                                    }
                                    if (similaritySelections.value === 'sim') {
                                        if (dis > slide.value / 100) {
                                            links.push({
                                                source: datas[i].name,
                                                target: datas[j].name,
                                            });
                                        }
                                    }

                                }
                            }
                        }
                        var myChart;
                        if (undefined != myChart) {
                            myChart.remove();
                        }

                        var myChart = echarts.init(
                            document.getElementById('graph')
                        )
                        myChart.clear();
                        var option = {
                            tooltip: {
                                show: true,
                                trigger: 'item',
                                formatter(params) {
                                    var out = '';
                                    // for (p in params) {
                                    out += '<p>' + '违法编号:' + params.data.wfbh + '</p>';
                                    out += '<p>' + '违法时间:' + params.data.wfsj + '</p>';
                                    out += '<p>' + '违法地址:' + params.data.wfdz + '</p>';
                                    out += '<p>' + '当事人:' + params.data.dsr + '</p>';
                                    out += '<p>' + '违法行为:' + params.data.wfxw + '</p>';
                                    out += '<p>' + '处理机关名称:' + params.data.cljgmc + '</p>';
                                    out += '<p>' + '罚款金额:' + params.data.fkje + '</p>';
                                    out += '<p>' + '违法记分数:' + params.data.wfjfs + '</p>';
                                    out += '<p>' + '事故等级:' + params.data.sgdj + '</p>';
                                    out += '<p>' + '行政区划:' + params.data.xzqh + '</p>';
                                    out += '<p>' + '公路行政等级:' + params.data.glxzdj + '</p>';
                                    out += '<p>' + '违法地点:' + params.data.wfdd + '</p>';
                                    out += '<p>' + '路口路段代码:' + params.data.lddm + '</p>';
                                    out += '<p>' + '驾驶证号:' + params.data.jszh + '</p>';
                                    out += '<p>' + '车辆分类:' + params.data.clfl + '</p>';
                                    out += '<p>' + '号牌种类:' + params.data.hpzl + '</p>';
                                    out += '<p>' + '号牌号码:' + params.data.hphm + '</p>';
                                    out += '<p>' + '机动车使用性质:' + params.data.syxz + '</p>';
                                    // }
                                    return out;
                                }
                            },
                            series: [{
                                type: 'graph',
                                layout: 'force',
                                roam: true,
                                symbolSize: (value, params) => {
                                    return value;
                                },
                                draggable: true,
                                data: datass,
                                force: {
                                    edgeLength: 200,
                                    repulsion: 300,
                                },
                                links: links,
                            }]
                        };
                        myChart.setOption(option);
                        // myChart.on('click', function(params) {
                        //     return false;
                        // });
                        //
                        // myChart.on('click', function (params) {
                        //     var similar_links = links.filter(
                        //         (o) => {
                        //             if ((o.target === params.name) || (o.source === params.name)) {
                        //                 return o;
                        //             }
                        //         }
                        //     )
                        //     var similar_datas_name = new Set();
                        //     for (var i = 0; i < similar_links.length; i++) {
                        //         similar_datas_name.add(similar_links[i].source);
                        //         similar_datas_name.add(similar_links[i].target);
                        //     }
                        //     var similar_datas_name = Array.from(similar_datas_name);
                        //     var similar_datas = datas.filter(
                        //         (o) => {
                        //             if (similar_datas_name.indexOf(o.name) >= 0) {
                        //                 return o;
                        //             }
                        //         }
                        //     )
                        //     console.log(similar_datas);
                        //
                        // });
                    }
                }
            }
            var CtorSelections = Vue.extend(MainSelections)
            var selections = new CtorSelections().$mount('#selections')

            var similaritySelections = new Vue({
                el: '#similarity_selections',
                data: {
                    options:[
                        {
                            value: 'sim',
                            label: '相似度',
                        },
                        {
                            value: 'dis',
                            label: '相异度',
                        }
                    ],
                    value: 'dis',
                }
            })

            var timeSlide;
            if (undefined != timeSlide) {
                timeSlide.$destroy();
            }
            var MainTimeSlide = {
                data() {
                    return {
                        value: [1, 86400]
                    }
                },
                methods: {
                    formatTooltip(val) {
                        var hour = parseInt(val/3600);
                        var minute = parseInt((val%3600)/60);
                        var second = parseInt(val%60);
                        return hour + ':' + minute + ':' + second;
                    }
                },
                watch: {
                    value: function() {
                        $.ajax({
                            url: "VIOLATION_eventgraph_ajax",
                            type: "POST",
                            data: {
                                // "times": calendar.value,
                                // "dissimilarity": slide.value
                                "time1": calendar.value[0],
                                "time2": calendar.value[1],
                                "time_range1": timeSlide.formatTooltip(timeSlide.value[0]),
                                "time_range2": timeSlide.formatTooltip(timeSlide.value[1]),
                            },
                            success: function(data) {
                                // var WFDDs = data["WFDDs"];
                                var WFDDs = new Array();
                                for (var i = 0; i < data.length; i++) {
                                    if (WFDDs.indexOf(data[i].wfdd) === -1) {
                                        WFDDs.push(data[i].wfdd);
                                    }
                                }
                                var wfdds = new Array();
                                for (var i = 0; i < WFDDs.length; i++) {
                                    var o = new Object();
                                    o.value = WFDDs[i];
                                    o.label = o.value;
                                    wfdds.push(o);
                                }
                                selections.options = [];
                                selections.options = wfdds;
                                selections.options.unshift({
                                    value: 'all',
                                    label: '全选'
                                });
                                datas = data;
                                links = new Array();
                                for (var i = 0; i < datas.length; i++) {
                                    datas[i].value = 20;
                                    datas[i].name = datas[i].wfbh;
                                }
                                var matrix = new Array(datas.length);
                                for (var i = 0; i < matrix.length; i++) {
                                    matrix[i] = new Array(datas.length);
                                }
                                for (var i = 0; i < datas.length; i++) {
                                    for (var j = 0; j < datas.length; j++) {
                                        if (i === j) {matrix[i][j] = 0;}
                                        else {
                                            var dis = dissimilarity(datas[i],datas[j], similaritySelections.value);
                                            matrix[i][j] = dis;
                                            if (similaritySelections.value === 'dis') {
                                                if (dis < slide.value / 100) {
                                                    links.push({
                                                        source: datas[i].name,
                                                        target: datas[j].name,
                                                    });
                                                }
                                            }
                                            if (similaritySelections.value === 'sim') {
                                                if (dis > slide.value / 100) {
                                                    links.push({
                                                        source: datas[i].name,
                                                        target: datas[j].name,
                                                    });
                                                }
                                            }

                                        }
                                    }
                                }
                                var myChart;
                                if (undefined != myChart) {
                                    myChart.remove();
                                }

                                var myChart = echarts.init(
                                    document.getElementById('graph')
                                )
                                myChart.clear();
                                var option = {
                                    tooltip: {
                                        show: true,
                                        trigger: 'item',
                                        formatter(params) {
                                            var out = '';
                                            // for (p in params) {
                                            out += '<p>' + '违法编号:' + params.data.wfbh + '</p>';
                                            out += '<p>' + '违法时间:' + params.data.wfsj + '</p>';
                                            out += '<p>' + '违法地址:' + params.data.wfdz + '</p>';
                                            out += '<p>' + '当事人:' + params.data.dsr + '</p>';
                                            out += '<p>' + '违法行为:' + params.data.wfxw + '</p>';
                                            out += '<p>' + '处理机关名称:' + params.data.cljgmc + '</p>';
                                            out += '<p>' + '罚款金额:' + params.data.fkje + '</p>';
                                            out += '<p>' + '违法记分数:' + params.data.wfjfs + '</p>';
                                            out += '<p>' + '事故等级:' + params.data.sgdj + '</p>';
                                            out += '<p>' + '行政区划:' + params.data.xzqh + '</p>';
                                            out += '<p>' + '公路行政等级:' + params.data.glxzdj + '</p>';
                                            out += '<p>' + '违法地点:' + params.data.wfdd + '</p>';
                                            out += '<p>' + '路口路段代码:' + params.data.lddm + '</p>';
                                            out += '<p>' + '驾驶证号:' + params.data.jszh + '</p>';
                                            out += '<p>' + '车辆分类:' + params.data.clfl + '</p>';
                                            out += '<p>' + '号牌种类:' + params.data.hpzl + '</p>';
                                            out += '<p>' + '号牌号码:' + params.data.hphm + '</p>';
                                            out += '<p>' + '机动车使用性质:' + params.data.syxz + '</p>';
                                            // }
                                            return out;
                                        }
                                    },
                                    series: [{
                                        type: 'graph',
                                        layout: 'force',
                                        roam: true,
                                        symbolSize: (value, params) => {
                                            return value;
                                        },
                                        draggable: true,
                                        data: datas,
                                        force: {
                                            edgeLength: 200,
                                            repulsion: 300,
                                            // gravity: 0.1
                                        },
                                        links: links,
                                    }]
                                };
                                myChart.setOption(option);
                                // myChart.on('click', function(params) {
                                //     return false;
                                // });
                                //
                                // myChart.on('click', function (params) {
                                //     var similar_links = links.filter(
                                //         (o) => {
                                //             if ((o.target === params.name) || (o.source === params.name)) {
                                //                 return o;
                                //             }
                                //         }
                                //     )
                                //     var similar_datas_name = new Set();
                                //     for (var i = 0; i < similar_links.length; i++) {
                                //         similar_datas_name.add(similar_links[i].source);
                                //         similar_datas_name.add(similar_links[i].target);
                                //     }
                                //     var similar_datas_name = Array.from(similar_datas_name);
                                //     var similar_datas = datas.filter(
                                //         (o) => {
                                //             if (similar_datas_name.indexOf(o.name) >= 0) {
                                //                 return o;
                                //             }
                                //         }
                                //     )
                                //     console.log(similar_datas);
                                //
                                // });
                            }
                        })
                    }
                }
            }
            var CtorTimeSlide = Vue.extend(MainTimeSlide)
            var timeSlide = new CtorTimeSlide().$mount('#time_slide')

            var table = new Vue({
                el: '#table',
                data:
                    {
                        message: "",
                        tableData: []
                    },
            });


            </script>



        </div>
    </div>


</div>

</div>


<script src="../../static/assets/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="../../static/assets/plugins/toaster/toastr.min.js"></script>
<script src="../../static/assets/plugins/slimscrollbar/jquery.slimscroll.min.js"></script>
<script src="../../static/assets/plugins/charts/Chart.min.js"></script>
<script src="../../static/assets/plugins/ladda/spin.min.js"></script>
<script src="../../static/assets/plugins/ladda/ladda.min.js"></script>
<script src="../../static/assets/plugins/jquery-mask-input/jquery.mask.min.js"></script>
<script src="../../static/assets/plugins/select2/js/select2.min.js"></script>
<script src="../../static/assets/plugins/jvectormap/jquery-jvectormap-2.0.3.min.js"></script>
<script src="../../static/assets/plugins/jvectormap/jquery-jvectormap-world-mill.js"></script>
<script src="../../static/assets/plugins/daterangepicker/moment.min.js"></script>
<script src="../../static/assets/plugins/daterangepicker/daterangepicker.js"></script>
<script src="../../static/assets/plugins/jekyll-search.min.js"></script>
<script src="../../static/assets/js/sleek.js"></script>
<script src="../../static/assets/js/chart.js"></script>
<script src="../../static/assets/js/date-range.js"></script>
<script src="../../static/assets/js/map.js"></script>
<script src="../../static/assets/js/custom.js"></script>


<!--<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>-->


</body>

</html>